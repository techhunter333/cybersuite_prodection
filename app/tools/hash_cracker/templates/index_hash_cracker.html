{% extends "base.html" %}

{% block header %}Password Hash Cracker{% endblock %}
{% block content %}
    
    <div class="tool-wrapper" style="max-width: 700px;">
        
        <div style="text-align: center; margin-bottom: 40px;">
            <div style="font-size: 3.8rem; color: var(--accent); margin-bottom: 16px;">
                <i class="fas fa-bolt"></i>
            </div>
            <h2 style="margin: 0; color: var(--text-main); font-size: 2.4rem; font-weight: 800;">Password Hash Cracker</h2>
            <p style="color: var(--text-muted); font-size: 1.2rem; margin-top: 8px;">
                Demonstrates wordlist attacks
            </p>
        </div>

        <form id="cracker-form" enctype="multipart/form-data">
            <div class="form-group">
                <label for="targetHash" style="font-weight: 700; margin-bottom: 12px; display: block;">Target Hash (Hex)</label>
                <input type="text" id="targetHash" name="targetHash" class="form-control styled-input" required placeholder="e.g., 5f4dcc3b5aa765d6...">
            </div>

            <div class="form-group">
                <label for="hashType" style="font-weight: 700; margin-bottom: 12px; display: block;">Hash Type</label>
                <select id="hashType" name="hashType" class="form-control styled-select">
                    <option value="md5">MD5</option>
                    <option value="sha1">SHA-1</option>
                    <option value="sha256" selected>SHA-256</option>
                    <option value="sha512">SHA-512</option>
                </select>
            </div>

            <div class="form-group">
                <label style="font-weight: 700; margin-bottom: 12px; display: block;">Wordlist Source</label>
                <div class="radio-group-hc">
                    <input type="radio" id="wordlistDefault" name="wordlistOption" value="default" checked>
                    <label for="wordlistDefault">Default Wordlist</label>
                    <input type="radio" id="wordlistUpload" name="wordlistOption" value="upload">
                    <label for="wordlistUpload">Upload Custom Wordlist</label>
                </div>
            </div>

            <div id="wordlist-file-input-area" class="form-group" style="display: none;">
                <label for="wordlistFile" style="font-weight: 700; margin-bottom: 12px; display: block;">Select Wordlist File (.txt)</label>
                <input type="file" id="wordlistFile" name="wordlistFile" class="form-control styled-file-input" accept=".txt, text/plain">
            </div>

            <button type="submit" id="crack-btn" class="btn-primary full-width warning-btn">
                <i class="fas fa-hammer"></i> Attempt to Crack
            </button>
        </form>
        
        <div id="status-area-hc" style="text-align: center; margin-top: 40px;">
            <div id="loading-spinner-hc" class="spinner" style="display: none;"></div>
            <p id="status-message-hc" style="font-weight: 700; color: var(--accent); font-size: 1.1rem; margin-top: 16px;"></p>
            <p id="error-message-hc" class="alert error" style="display: none; margin-top: 20px;"></p>
        </div>
        
        <div id="results-area-hc" class="result-section" style="display: none;">
            <h3 style="font-size: 1.6rem; margin-bottom: 24px; color: var(--text-main); font-weight: 800;">
                Cracking Results
            </h3>
            <p><strong>Status:</strong> <span id="result-status-hc" class="status-text"></span></p>
            <p><strong>Password:</strong> <code id="result-password-hc" class="code-block"></code></p>
            <p><strong>Attempts:</strong> <span id="result-attempts-hc"></span></p>
        </div>
    </div>

    <!-- Premium Hash Cracker CSS -->
    <style>
        /* Wordlist Toggle - Pill Buttons */
        .radio-group-hc {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
        }

        .radio-group-hc input[type="radio"] {
            display: none;
        }

        .radio-group-hc label {
            flex: 1;
            padding: 16px;
            text-align: center;
            border: 1px solid var(--border);
            background: var(--bg-body);
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.05rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
        }

        .radio-group-hc input[type="radio"]:checked + label {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            box-shadow: 0 6px 16px rgba(99,102,241,0.3);
        }

        /* Inputs & Select */
        .styled-input, .styled-select {
            padding: 18px 24px;
            font-size: 1.1rem;
            border-radius: 16px;
            background: var(--bg-body);
            border: 1px solid var(--border);
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
        }

        .styled-input:focus, .styled-select:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(99,102,241,0.15);
        }

        .styled-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236366f1' viewBox='0 0 16 16'%3E%3Cpath d='M4 6l4 4 4-4z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 24px center;
            padding-right: 60px;
        }

        .styled-file-input {
            padding: 16px;
            border-radius: 16px;
            background: var(--bg-body);
            border: 2px dashed var(--border);
            transition: all 0.3s ease;
        }

        .styled-file-input:hover {
            border-color: var(--accent);
        }

        /* Crack Button - Red Warning Style */
        .warning-btn {
            background: #dc2626 !important; /* red-600 */
            padding: 20px;
            font-size: 1.2rem;
            font-weight: 700;
            border-radius: 50px;
            box-shadow: 0 8px 20px rgba(220,38,38,0.3);
            transition: all 0.3s ease;
        }

        .warning-btn:hover {
            background: #b91c1c !important;
            transform: translateY(-3px);
            box-shadow: 0 12px 28px rgba(220,38,38,0.4);
        }

        /* Results */
        .result-section {
            margin-top: 40px;
            padding: 32px;
            background: var(--bg-body);
            border-radius: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
        }

        .code-block {
            background: var(--bg-card);
            padding: 12px 16px;
            border-radius: 12px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            word-break: break-all;
            display: block;
            margin: 12px 0;
            border: 1px solid var(--border);
        }

        .status-text.found {
            color: #16a34a;
            font-weight: 800;
            font-size: 1.4rem;
        }

        .status-text.not-found {
            color: #dc2626;
            font-weight: 800;
            font-size: 1.4rem;
        }

        /* Spinner */
        .spinner {
            width: 60px;
            height: 60px;
            border: 6px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1.2s ease-in-out infinite;
            margin: 40px auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('hash_cracker.static', filename='script.js') }}"></script>
{% endblock %}